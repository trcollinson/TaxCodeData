DELIMITER //

DROP PROCEDURE IF EXISTS `handleTaxCodes`;

CREATE PROCEDURE `handleTaxCodes`()
BEGIN

    CALL getTaxData("207K00000X");
    CALL getTaxData("207KA0200X");
    CALL getTaxData("207KI0005X");
    CALL getTaxData("207L00000X");
    CALL getTaxData("207LA0401X");
    CALL getTaxData("207LC0200X");
    CALL getTaxData("207LH0002X");
    CALL getTaxData("207LP2900X");
    CALL getTaxData("207LP3000X");
    CALL getTaxData("208U00000X");
    CALL getTaxData("208C00000X");
    CALL getTaxData("207N00000X");
    CALL getTaxData("207NI0002X");
    CALL getTaxData("207ND0900X");
    CALL getTaxData("207ND0101X");
    CALL getTaxData("207NP0225X");
    CALL getTaxData("207NS0135X");
    CALL getTaxData("204R00000X");
    CALL getTaxData("207P00000X");
    CALL getTaxData("207PE0004X");
    CALL getTaxData("207PH0002X");
    CALL getTaxData("207PT0002X");
    CALL getTaxData("207PP0204X");
    CALL getTaxData("207PS0010X");
    CALL getTaxData("207PE0005X");
    CALL getTaxData("207Q00000X");
    CALL getTaxData("207QA0401X");
    CALL getTaxData("207QA0000X");
    CALL getTaxData("207QA0505X");
    CALL getTaxData("207QB0002X");
    CALL getTaxData("207QG0300X");
    CALL getTaxData("207QH0002X");
    CALL getTaxData("207QS1201X");
    CALL getTaxData("207QS0010X");
    CALL getTaxData("208D00000X");
    CALL getTaxData("208M00000X");
    CALL getTaxData("202C00000X");
    CALL getTaxData("207R00000X");
    CALL getTaxData("207RA0401X");
    CALL getTaxData("207RA0000X");
    CALL getTaxData("207RA0201X");
    CALL getTaxData("207RB0002X");
    CALL getTaxData("207RC0000X");
    CALL getTaxData("207RI0001X");
    CALL getTaxData("207RC0001X");
    CALL getTaxData("207RC0200X");
    CALL getTaxData("207RE0101X");
    CALL getTaxData("207RG0100X");
    CALL getTaxData("207RG0300X");
    CALL getTaxData("207RH0000X");
    CALL getTaxData("207RH0003X");
    CALL getTaxData("207RI0008X");
    CALL getTaxData("207RH0002X");
    CALL getTaxData("207RI0200X");
    CALL getTaxData("207RI0011X");
    CALL getTaxData("207RM1200X");
    CALL getTaxData("207RX0202X");
    CALL getTaxData("207RN0300X");
    CALL getTaxData("207RP1001X");
    CALL getTaxData("207RR0500X");
    CALL getTaxData("207RS0012X");
    CALL getTaxData("207RS0010X");
    CALL getTaxData("207RT0003X");
    CALL getTaxData("209800000X");
    CALL getTaxData("207SG0202X");
    CALL getTaxData("207SC0300X");
    CALL getTaxData("207SG0201X");
    CALL getTaxData("207SG0203X");
    CALL getTaxData("207SM0001X");
    CALL getTaxData("207SG0205X");
    CALL getTaxData("207T00000X");
    CALL getTaxData("207U00000X");
    CALL getTaxData("207UN0903X");
    CALL getTaxData("207UN0901X");
    CALL getTaxData("207UN0902X");
    CALL getTaxData("204D00000X");
    CALL getTaxData("204C00000X");
    CALL getTaxData("207V00000X");
    CALL getTaxData("207VB0002X");
    CALL getTaxData("207VC0200X");
    CALL getTaxData("207VX0201X");
    CALL getTaxData("207VG0400X");
    CALL getTaxData("207VH0002X");
    CALL getTaxData("207VM0101X");
    CALL getTaxData("207VX0000X");
    CALL getTaxData("207VE0102X");
    CALL getTaxData("207W00000X");
    CALL getTaxData("204E00000X");
    CALL getTaxData("207X00000X");
    CALL getTaxData("207XS0114X");
    CALL getTaxData("207XX0004X");
    CALL getTaxData("207XS0106X");
    CALL getTaxData("207XS0117X");
    CALL getTaxData("207XX0801X");
    CALL getTaxData("207XP3100X");
    CALL getTaxData("207XX0005X");
    CALL getTaxData("207Y00000X");
    CALL getTaxData("207YS0123X");
    CALL getTaxData("207YX0602X");
    CALL getTaxData("207YX0905X");
    CALL getTaxData("207YX0901X");
    CALL getTaxData("207YP0228X");
    CALL getTaxData("207YX0007X");
    CALL getTaxData("207YS0012X");
    CALL getTaxData("207ZP0101X");
    CALL getTaxData("207ZP0102X");
    CALL getTaxData("207ZB0001X");
    CALL getTaxData("207ZP0104X");
    CALL getTaxData("207ZC0006X");
    CALL getTaxData("207ZP0105X");
    CALL getTaxData("207ZC0500X");
    CALL getTaxData("207ZD0900X");
    CALL getTaxData("207ZF0201X");
    CALL getTaxData("207ZH0000X");
    CALL getTaxData("207ZI0100X");
    CALL getTaxData("207ZM0300X");
    CALL getTaxData("207ZP0007X");
    CALL getTaxData("207ZN0500X");
    CALL getTaxData("207ZP0213X");
    CALL getTaxData("208000000X");
    CALL getTaxData("2080A0000X");
    CALL getTaxData("2080C0008X");
    CALL getTaxData("2080I0007X");
    CALL getTaxData("2080P0006X");
    CALL getTaxData("2080H0002X");
    CALL getTaxData("2080T0002X");
    CALL getTaxData("2080N0001X");
    CALL getTaxData("2080P0008X");
    CALL getTaxData("2080P0201X");
    CALL getTaxData("2080P0202X");
    CALL getTaxData("2080P0203X");
    CALL getTaxData("2080P0204X");
    CALL getTaxData("2080P0205X");
    CALL getTaxData("2080P0206X");
    CALL getTaxData("2080P0207X");
    CALL getTaxData("2080P0208X");
    CALL getTaxData("2080P0210X");
    CALL getTaxData("2080P0214X");
    CALL getTaxData("2080P0216X");
    CALL getTaxData("2080T0004X");
    CALL getTaxData("2080S0012X");
    CALL getTaxData("2080S0010X");
    CALL getTaxData("202K00000X");
    CALL getTaxData("208100000X");
    CALL getTaxData("2081H0002X");
    CALL getTaxData("2081N0008X");
    CALL getTaxData("2081P2900X");
    CALL getTaxData("2081P0010X");
    CALL getTaxData("2081P0004X");
    CALL getTaxData("2081S0010X");
    CALL getTaxData("208200000X");
    CALL getTaxData("2082S0099X");
    CALL getTaxData("2082S0105X");
    CALL getTaxData("2083A0100X");
    CALL getTaxData("2083T0002X");
    CALL getTaxData("2083X0100X");
    CALL getTaxData("2083P0500X");
    CALL getTaxData("2083P0901X");
    CALL getTaxData("2083S0010X");
    CALL getTaxData("2084A0401X");
    CALL getTaxData("2084P0802X");
    CALL getTaxData("2084B0002X");
    CALL getTaxData("2084P0804X");
    CALL getTaxData("2084N0600X");
    CALL getTaxData("2084D0003X");
    CALL getTaxData("2084F0202X");
    CALL getTaxData("2084P0805X");
    CALL getTaxData("2084H0002X");
    CALL getTaxData("2084P0005X");
    CALL getTaxData("2084N0400X");
    CALL getTaxData("2084N0402X");
    CALL getTaxData("2084N0008X");
    CALL getTaxData("2084P2900X");
    CALL getTaxData("2084P0800X");
    CALL getTaxData("2084P0015X");
    CALL getTaxData("2084S0012X");
    CALL getTaxData("2084S0010X");
    CALL getTaxData("2084V0102X");
    CALL getTaxData("208VP0014X");
    CALL getTaxData("208VP0000X");
    CALL getTaxData("2085B0100X");
    CALL getTaxData("2085D0003X");
    CALL getTaxData("2085R0202X");
    CALL getTaxData("2085U0001X");
    CALL getTaxData("2085H0002X");
    CALL getTaxData("2085N0700X");
    CALL getTaxData("2085N0904X");
    CALL getTaxData("2085P0229X");
    CALL getTaxData("2085R0001X");
    CALL getTaxData("2085R0205X");
    CALL getTaxData("2085R0203X");
    CALL getTaxData("2085R0204X");
    CALL getTaxData("208600000X");
    CALL getTaxData("2086H0002X");
    CALL getTaxData("2086S0120X");
    CALL getTaxData("2086S0122X");
    CALL getTaxData("2086S0105X");
    CALL getTaxData("2086S0102X");
    CALL getTaxData("2086X0206X");
    CALL getTaxData("2086S0127X");
    CALL getTaxData("2086S0129X");
    CALL getTaxData("208G00000X");
    CALL getTaxData("204F00000X");
    CALL getTaxData("208800000X");
    CALL getTaxData("2088P0231X");

    SET @delete_phone_table = 'DROP TABLE IF EXISTS phone_new';
    SET @create_phone_table = 'CREATE TABLE IF NOT EXISTS phone_new (phone_num VARCHAR(20))';

    PREPARE drop_phone_statement FROM @delete_phone_table;
    PREPARE create_phone_statement FROM @create_phone_table;

    EXECUTE drop_phone_statement;
    EXECUTE create_phone_statement;

    DEALLOCATE PREPARE drop_phone_statement;
    DEALLOCATE PREPARE create_phone_statement;

    CALL compilePhone("207K00000X");
    CALL compilePhone("207KA0200X");
    CALL compilePhone("207KI0005X");
    CALL compilePhone("207L00000X");
    CALL compilePhone("207LA0401X");
    CALL compilePhone("207LC0200X");
    CALL compilePhone("207LH0002X");
    CALL compilePhone("207LP2900X");
    CALL compilePhone("207LP3000X");
    CALL compilePhone("208U00000X");
    CALL compilePhone("208C00000X");
    CALL compilePhone("207N00000X");
    CALL compilePhone("207NI0002X");
    CALL compilePhone("207ND0900X");
    CALL compilePhone("207ND0101X");
    CALL compilePhone("207NP0225X");
    CALL compilePhone("207NS0135X");
    CALL compilePhone("204R00000X");
    CALL compilePhone("207P00000X");
    CALL compilePhone("207PE0004X");
    CALL compilePhone("207PH0002X");
    CALL compilePhone("207PT0002X");
    CALL compilePhone("207PP0204X");
    CALL compilePhone("207PS0010X");
    CALL compilePhone("207PE0005X");
    CALL compilePhone("207Q00000X");
    CALL compilePhone("207QA0401X");
    CALL compilePhone("207QA0000X");
    CALL compilePhone("207QA0505X");
    CALL compilePhone("207QB0002X");
    CALL compilePhone("207QG0300X");
    CALL compilePhone("207QH0002X");
    CALL compilePhone("207QS1201X");
    CALL compilePhone("207QS0010X");
    CALL compilePhone("208D00000X");
    CALL compilePhone("208M00000X");
    CALL compilePhone("202C00000X");
    CALL compilePhone("207R00000X");
    CALL compilePhone("207RA0401X");
    CALL compilePhone("207RA0000X");
    CALL compilePhone("207RA0201X");
    CALL compilePhone("207RB0002X");
    CALL compilePhone("207RC0000X");
    CALL compilePhone("207RI0001X");
    CALL compilePhone("207RC0001X");
    CALL compilePhone("207RC0200X");
    CALL compilePhone("207RE0101X");
    CALL compilePhone("207RG0100X");
    CALL compilePhone("207RG0300X");
    CALL compilePhone("207RH0000X");
    CALL compilePhone("207RH0003X");
    CALL compilePhone("207RI0008X");
    CALL compilePhone("207RH0002X");
    CALL compilePhone("207RI0200X");
    CALL compilePhone("207RI0011X");
    CALL compilePhone("207RM1200X");
    CALL compilePhone("207RX0202X");
    CALL compilePhone("207RN0300X");
    CALL compilePhone("207RP1001X");
    CALL compilePhone("207RR0500X");
    CALL compilePhone("207RS0012X");
    CALL compilePhone("207RS0010X");
    CALL compilePhone("207RT0003X");
    CALL compilePhone("209800000X");
    CALL compilePhone("207SG0202X");
    CALL compilePhone("207SC0300X");
    CALL compilePhone("207SG0201X");
    CALL compilePhone("207SG0203X");
    CALL compilePhone("207SM0001X");
    CALL compilePhone("207SG0205X");
    CALL compilePhone("207T00000X");
    CALL compilePhone("207U00000X");
    CALL compilePhone("207UN0903X");
    CALL compilePhone("207UN0901X");
    CALL compilePhone("207UN0902X");
    CALL compilePhone("204D00000X");
    CALL compilePhone("204C00000X");
    CALL compilePhone("207V00000X");
    CALL compilePhone("207VB0002X");
    CALL compilePhone("207VC0200X");
    CALL compilePhone("207VX0201X");
    CALL compilePhone("207VG0400X");
    CALL compilePhone("207VH0002X");
    CALL compilePhone("207VM0101X");
    CALL compilePhone("207VX0000X");
    CALL compilePhone("207VE0102X");
    CALL compilePhone("207W00000X");
    CALL compilePhone("204E00000X");
    CALL compilePhone("207X00000X");
    CALL compilePhone("207XS0114X");
    CALL compilePhone("207XX0004X");
    CALL compilePhone("207XS0106X");
    CALL compilePhone("207XS0117X");
    CALL compilePhone("207XX0801X");
    CALL compilePhone("207XP3100X");
    CALL compilePhone("207XX0005X");
    CALL compilePhone("207Y00000X");
    CALL compilePhone("207YS0123X");
    CALL compilePhone("207YX0602X");
    CALL compilePhone("207YX0905X");
    CALL compilePhone("207YX0901X");
    CALL compilePhone("207YP0228X");
    CALL compilePhone("207YX0007X");
    CALL compilePhone("207YS0012X");
    CALL compilePhone("207ZP0101X");
    CALL compilePhone("207ZP0102X");
    CALL compilePhone("207ZB0001X");
    CALL compilePhone("207ZP0104X");
    CALL compilePhone("207ZC0006X");
    CALL compilePhone("207ZP0105X");
    CALL compilePhone("207ZC0500X");
    CALL compilePhone("207ZD0900X");
    CALL compilePhone("207ZF0201X");
    CALL compilePhone("207ZH0000X");
    CALL compilePhone("207ZI0100X");
    CALL compilePhone("207ZM0300X");
    CALL compilePhone("207ZP0007X");
    CALL compilePhone("207ZN0500X");
    CALL compilePhone("207ZP0213X");
    CALL compilePhone("208000000X");
    CALL compilePhone("2080A0000X");
    CALL compilePhone("2080C0008X");
    CALL compilePhone("2080I0007X");
    CALL compilePhone("2080P0006X");
    CALL compilePhone("2080H0002X");
    CALL compilePhone("2080T0002X");
    CALL compilePhone("2080N0001X");
    CALL compilePhone("2080P0008X");
    CALL compilePhone("2080P0201X");
    CALL compilePhone("2080P0202X");
    CALL compilePhone("2080P0203X");
    CALL compilePhone("2080P0204X");
    CALL compilePhone("2080P0205X");
    CALL compilePhone("2080P0206X");
    CALL compilePhone("2080P0207X");
    CALL compilePhone("2080P0208X");
    CALL compilePhone("2080P0210X");
    CALL compilePhone("2080P0214X");
    CALL compilePhone("2080P0216X");
    CALL compilePhone("2080T0004X");
    CALL compilePhone("2080S0012X");
    CALL compilePhone("2080S0010X");
    CALL compilePhone("202K00000X");
    CALL compilePhone("208100000X");
    CALL compilePhone("2081H0002X");
    CALL compilePhone("2081N0008X");
    CALL compilePhone("2081P2900X");
    CALL compilePhone("2081P0010X");
    CALL compilePhone("2081P0004X");
    CALL compilePhone("2081S0010X");
    CALL compilePhone("208200000X");
    CALL compilePhone("2082S0099X");
    CALL compilePhone("2082S0105X");
    CALL compilePhone("2083A0100X");
    CALL compilePhone("2083T0002X");
    CALL compilePhone("2083X0100X");
    CALL compilePhone("2083P0500X");
    CALL compilePhone("2083P0901X");
    CALL compilePhone("2083S0010X");
    CALL compilePhone("2084A0401X");
    CALL compilePhone("2084P0802X");
    CALL compilePhone("2084B0002X");
    CALL compilePhone("2084P0804X");
    CALL compilePhone("2084N0600X");
    CALL compilePhone("2084D0003X");
    CALL compilePhone("2084F0202X");
    CALL compilePhone("2084P0805X");
    CALL compilePhone("2084H0002X");
    CALL compilePhone("2084P0005X");
    CALL compilePhone("2084N0400X");
    CALL compilePhone("2084N0402X");
    CALL compilePhone("2084N0008X");
    CALL compilePhone("2084P2900X");
    CALL compilePhone("2084P0800X");
    CALL compilePhone("2084P0015X");
    CALL compilePhone("2084S0012X");
    CALL compilePhone("2084S0010X");
    CALL compilePhone("2084V0102X");
    CALL compilePhone("208VP0014X");
    CALL compilePhone("208VP0000X");
    CALL compilePhone("2085B0100X");
    CALL compilePhone("2085D0003X");
    CALL compilePhone("2085R0202X");
    CALL compilePhone("2085U0001X");
    CALL compilePhone("2085H0002X");
    CALL compilePhone("2085N0700X");
    CALL compilePhone("2085N0904X");
    CALL compilePhone("2085P0229X");
    CALL compilePhone("2085R0001X");
    CALL compilePhone("2085R0205X");
    CALL compilePhone("2085R0203X");
    CALL compilePhone("2085R0204X");
    CALL compilePhone("208600000X");
    CALL compilePhone("2086H0002X");
    CALL compilePhone("2086S0120X");
    CALL compilePhone("2086S0122X");
    CALL compilePhone("2086S0105X");
    CALL compilePhone("2086S0102X");
    CALL compilePhone("2086X0206X");
    CALL compilePhone("2086S0127X");
    CALL compilePhone("2086S0129X");
    CALL compilePhone("208G00000X");
    CALL compilePhone("204F00000X");
    CALL compilePhone("208800000X");
    CALL compilePhone("2088P0231X");

    SET @remove_hyphen = 'UPDATE phone_new SET phone_num = replace(phone_num, \'-\', \'\')';
    PREPARE remove_hyphen_statement FROM @remove_hyphen;
    EXECUTE remove_hyphen_statement;
    DEALLOCATE PREPARE remove_hyphen_statement;

    SET @dedupe = 'ALTER IGNORE TABLE phone_new ADD UNIQUE INDEX inx_phone (phone_num)';
    PREPARE dedupe_statement FROM @dedupe;
    EXECUTE dedupe_statement;
    DEALLOCATE PREPARE dedupe_statement;


END

//
